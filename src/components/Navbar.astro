---
import "../styles/global.css";
import "../utils/helperes.js";
import { getNombreSeccion } from "../utils/helperes.js";
---

<nav class="w-full fixed top-0 left-0 z-50 bg-black pt-3">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      <!-- Logo o Nombre -->
      <div class="flex-shrink-0 w-40">
        <a href="#home">
          <img class="flex-shrink-0 max-w-20" src="/logo_blanco.png" />
        </a>
      </div>

      <!-- Links de navegación -->
      <div
        class="hidden lg:flex space-x-6 border border-solid rounded-4xl p-1.5 pl-2.5 pr-2.5"
      >
        <a
          href="#sobre-mi"
          class="pl-1 pr-1 hover:bg-white rounded-4xl hover:text-black transition duration-700"
          >{getNombreSeccion("sobreMi")}</a
        >
        <a
          href="#conocimientos"
          class="pl-1 pr-1 hover:bg-white rounded-4xl hover:text-black transition duration-700"
          >{getNombreSeccion("conocimientos")}</a
        >
        <a
          href="#proyectos"
          class="pl-1 pr-1 hover:bg-white rounded-4xl hover:text-black transition duration-700"
          >{getNombreSeccion("proyectos")}</a
        >
        <a
          href="#formacion"
          class="pl-1 pr-1 hover:bg-white rounded-4xl hover:text-black transition duration-700"
          >{getNombreSeccion("formacion")}</a
        >
        <a
          href="#contacto"
          class="pl-1 pr-1 hover:bg-white rounded-4xl hover:text-black transition duration-700"
          >{getNombreSeccion("contacto")}</a
        >
      </div>

      <!-- Botón de descarga de CV -->
      <div class="hidden lg:flex w-40 justify-end">
        <a
          href="/public/CV_Jefferson_Vivas_Vasquez.pdf"
          download="Jefferson_Vivas_CV.pdf"
          class="bg-fuchsia-800 text-white px-4 py-2 rounded-lg hover:bg-blue-400 hover:text-black transition duration-700"
        >
          Descargar CV
        </a>
      </div>

      <!-- Menú móvil (icono hamburguesa) -->
      <div class="lg:hidden">
        <!-- Aquí podrías implementar un botón con JS o usar Alpine.js si quieres interactividad -->
        <button class="focus:outline-none" onclick="toggleMenu()">
          <svg
            class="h-6 w-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Menú móvil desplegable -->
  <div class="flex w-full justify-center items-center pb-2.5">
    <!-- MAX-W-2XS Para que la letra se adapte al tamaño de la "caja" -->
    <div
      id="mobile-menu"
      class="hidden flex flex-col justify-center items-center max-w-2xs space-y-2 mt-2 border border-solid rounded-4xl p-4 bg-black lg:hidden"
    >
      <a href="#sobre-mi" class="block transition"
        >{getNombreSeccion("sobreMi")}</a
      >
      <a href="#conocimientos" class="block transition"
        >{getNombreSeccion("conocimientos")}</a
      >
      <a href="#proyectos" class="block transition"
        >{getNombreSeccion("proyectos")}</a
      >
      <a href="#formacion" class="block transition"
        >{getNombreSeccion("formacion")}</a
      >
      <a href="#contacto" class="block transition"
        >{getNombreSeccion("contacto")}</a
      >
      <a
        href="/cv.pdf"
        target="_blank"
        class="block bg-fuchsia-800 text-white px-4 py-2 rounded-lg hover:bg-blue-400 hover:text-black transition duration-700 mt-2"
      >
        Descargar CV
      </a>
    </div>
  </div>
</nav>

<script is:inline>
  function toggleMenu() {
    const menu = document.getElementById("mobile-menu");
    if (menu) {
      menu.classList.toggle("hidden");
    }
  }

  function onMouse() {
    const menu = document.getElementsByTagName;
  }

  const secciones = [
    {id: "sobre-mi", link: "#sobre-mi"},
    {id: "conocimientos", link: "#conocimientos"},
    {id: "proyectos", link: "#proyectos"},
    {id: "formacion", link: "#formacion"},
    {id: "contacto", link: "#contacto"}
  ];

  function marcarSeccionActiva(){
    let scrollPos = window.scrollY || window.pageXOffset;
    let offset = 100; // Ajusta este valor según sea necesario

    for (let i=0; i < secciones.length; i++){
      const seccion = document.getElementById(secciones[i].id);
      if (seccion && seccion.offsetTop - offset <= scrollPos) {
        seccionActiva = secciones[i].id;
      }
    }

    // Actualizar el enlace activo en el menú
    document.querySelectorAll('nav a[href^="#"]').forEach(a => {
      a.classList.remove("active-navbar-link");
      if (a.getAttribute("href") === "#" + seccionActiva) {
        a.classList.add("active-navbar-link");
      }
    });

  }

  window.addEventListener("scroll", marcarSeccionActiva);
  window.addEventListener("DOMContentLoaded", marcarSeccionActiva);
</script>
